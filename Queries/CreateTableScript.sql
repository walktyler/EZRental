CREATE TABLE CUSTOMERUSERACCOUNT(
    USERACCOUNTID RAW(16) DEFAULT SYS_GUID() PRIMARY KEY,
    USERNAME VARCHAR2(50) NOT NULL UNIQUE,      
    PASSWORD VARCHAR2(20) NOT NULL,
    EMAIL VARCHAR2(75) NOT NULL UNIQUE
);  
CREATE TABLE DRIVERLICENSE(
    DRIVERLICENSENUMBER VARCHAR2(20) PRIMARY KEY,
    DRIVERLICENSEEXPDATE DATE NOT NULL,
    DRIVERLICENSESTATE CHAR(2) NOT NULL
);

CREATE TABLE DISCOUNT(
    DISCOUNTID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    DISCOUNTCODE CHAR(10) NOT NULL,
    DISCOUNTCODEDESC VARCHAR2(150) NOT NULL
);

CREATE TABLE EZPLUS(
    EZPLUSID NUMBER(10) PRIMARY KEY,
    EZPLUSREWARDSCODE CHAR(13) NOT NULL UNIQUE, 
    EZPLUSREWARDSEARNEDPOINTS NUMBER(6) NOT NULL 
);

CREATE TABLE CUSTOMER(
    CUSTOMERID NUMBER(9) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    FIRSTNAME VARCHAR2(30) NOT NULL,
    LASTNAME VARCHAR2(30) NOT NULL,
    BIRTHDATE DATE NOT NULL,
    ADDRESSLINE1 VARCHAR2(75) NOT NULL,
    ADDRESSLINE2 VARCHAR2(75) NULL,
    CITY VARCHAR2(15) NOT NULL,
    STATECODE CHAR(2) NOT NULL,
    ZIPCODE VARCHAR2(10) NOT NULL,
    COUNTRY VARCHAR2(50) NOT NULL,
    PHONE VARCHAR2(11) NOT NULL,
    EMAIL VARCHAR2(75) NOT NULL UNIQUE,
    DRIVERLICENSENUMBER VARCHAR2(20) NOT NULL UNIQUE,
    CUSTOMERUSERACCOUNTID RAW(16) NOT NULL,
    CUSTOMERTYPE CHAR(1) NOT NULL,
    FOREIGN KEY (CUSTOMERUSERACCOUNTID) REFERENCES CUSTOMERUSERACCOUNT(USERACCOUNTID),
    FOREIGN KEY (DRIVERLICENSENUMBER) REFERENCES DRIVERLICENSE(DRIVERLICENSENUMBER),
    CONSTRAINT CK_CUST_TYPE CHECK (UPPER(CUSTOMERTYPE) IN ('R', 'C')) 
);    

CREATE TABLE RETAILCUSTOMER(
    CUSTOMERID NUMBER(9) NOT NULL PRIMARY KEY,
    DISCOUNTID NUMBER(9) NULL,
    EZPLUSID NUMBER(10) NULL,
    FOREIGN KEY (CUSTOMERID) REFERENCES CUSTOMER(CUSTOMERID),
    FOREIGN KEY (DISCOUNTID) REFERENCES DISCOUNT(DISCOUNTID),
    FOREIGN KEY (EZPLUSID) REFERENCES EZPLUS(EZPLUSID)
);

CREATE TABLE COMPANY(
    COMPANYID NUMBER(5) GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    COMPANYNAME VARCHAR2(50) NOT NULL UNIQUE,
    ADDRESSLINE1 VARCHAR2(75) NOT NULL,
    ADDRESSLINE2 VARCHAR2(75) NULL,
    CITY VARCHAR2(50) NOT NULL,
    STATECODE CHAR(2) NOT NULL,
    ZIPCODE VARCHAR2(10) NOT NULL,
    COUNTRY VARCHAR2(90) NOT NULL,
    COMPANYREPNAME VARCHAR2(30) NOT NULL,
    CONTACTPHONE VARCHAR2(11) NOT NULL UNIQUE,
    CONTACTEMAIL VARCHAR2(75) NOT NULL UNIQUE,
    COMPANYDISCOUNTPERCENTAGE NUMBER(3,1) NOT NULL,
    CONSTRAINT CK_COMPANYLIMIT CHECK (COMPANYID BETWEEN 1 AND 20000)
);

CREATE TABLE CORPORATECUSTOMER(
    CUSTOMERID NUMBER(9) PRIMARY KEY,
    COMPANYID NUMBER(9) NOT NULL,
    FOREIGN KEY (CUSTOMERID) REFERENCES CUSTOMER(CUSTOMERID),
    FOREIGN KEY (COMPANYID) REFERENCES COMPANY(COMPANYID)
);

CREATE TABLE CREDITCARD(
    CREDITCARDNUMBER VARCHAR2(16) PRIMARY KEY,
    OWNERNAME VARCHAR2(50) NOT NULL,
    MERCHANTNAME VARCHAR2(50) NOT NULL,
    EXPDATE DATE NOT NULL,
    ADDRESSLINE1 VARCHAR2(75) NOT NULL,
    ADDRESSLINE2 VARCHAR2(75) NULL,
    CITY VARCHAR2(50) NOT NULL,
    STATECODE CHAR(2) NOT NULL,
    ZIPCODE VARCHAR2(10) NOT NULL,
    COUNTRY VARCHAR2(75) NOT NULL,
    CREDITCARDLIMIT NUMBER(7,2) NOT NULL,
    CREDITCARDBALANCE NUMBER(7,2) NOT NULL,
    ACTIVATIONSTATUS CHAR(1) NOT NULL,
    CONSTRAINT ck_ISACTIVATED CHECK (ACTIVATIONSTATUS IN ('0','1')),
    CONSTRAINT ck_CREDITCARDMIN CHECK (NOT LENGTH(CREDITCARDNUMBER) <= 12)
);

CREATE TABLE CUSTOMERCREDITCARD(
    CARDNUMBER VARCHAR2(16) NOT NULL,
    CUSTOMERID NUMBER(9) NOT NULL,
    CONSTRAINT PK_CUSTOMERCREDITCARD PRIMARY KEY (CARDNUMBER, CUSTOMERID),
    FOREIGN KEY (CARDNUMBER) REFERENCES CREDITCARD(CREDITCARDNUMBER),
    FOREIGN KEY (CUSTOMERID) REFERENCES CUSTOMER(CUSTOMERID)
);

CREATE TABLE VEHICLERENTALCATEGORY(
    VEHICLERENTALCATEGORYID NUMBER(2) PRIMARY KEY,
    CATEGORYNAME VARCHAR2(50) NOT NULL,
    CATEGORYDAILYRENTALRATE NUMBER(5,2) NOT NULL
);

CREATE TABLE VEHICLESTATUS(
    VEHICLESTATUSID NUMBER(1) PRIMARY KEY,
    VEHICLESTATUSDESC VARCHAR2(30) NOT NULL
);

CREATE TABLE RENTALAGENCY(
    RENTALAGENCYID NUMBER(5) PRIMARY KEY,
    RENTALAGENCYNAME VARCHAR2(50) NOT NULL,
    ADDRESSLINE1 VARCHAR2(75) NOT NULL,
    ADDRESSLINE2 VARCHAR2(75) NULL,
    CITY VARCHAR(50) NOT NULL,
    STATECODE CHAR(2) NOT NULL,
    COUNTRY VARCHAR2(50) NOT NULL,
    ZIPCODE VARCHAR2(10) NOT NULL,
    PHONE VARCHAR2(20) NOT NULL,
    EMAIL VARCHAR2(75) NOT NULL UNIQUE
);

CREATE TABLE VEHICLE(
    VEHICLEID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    VINNUMBER VARCHAR2(17) UNIQUE NOT NULL,
    MAKE VARCHAR2(30) NOT NULL,
    MODEL VARCHAR2(30) NOT NULL,
    YEAR NUMBER(4) NOT NULL,
    COLOR VARCHAR2(20) NOT NULL,
    LICENSEPLATENUMBER VARCHAR2(10) NOT NULL,
    MILEAGE NUMBER(6) NOT NULL,
    TRANSMISSIONTYPE VARCHAR2(50) NOT NULL,
    SEATCAPACITY NUMBER(1) NOT NULL,
    VEHICLERENTALCATEGORYID NUMBER(2) NOT NULL,
    VEHICLESTATUSID NUMBER(1) NOT NULL ,
    VEHICLEOWNINGAGENCYID NUMBER(9) NOT NULL,
    VEHICLECURRENTLOCATIONAGENCYID NUMBER(9) NOT NULL,
    VEHICLETYPE CHAR(1) CHECK (VEHICLETYPE IN ('C', 'S','M','V')) NOT NULL,
    FOREIGN KEY (VEHICLERENTALCATEGORYID) REFERENCES VEHICLERENTALCATEGORY (VEHICLERENTALCATEGORYID),
    FOREIGN KEY (VEHICLESTATUSID) REFERENCES VEHICLESTATUS(VEHICLESTATUSID),
    FOREIGN KEY (VEHICLEOWNINGAGENCYID) REFERENCES RENTALAGENCY(RENTALAGENCYID),
    FOREIGN KEY (VEHICLECURRENTLOCATIONAGENCYID) REFERENCES RENTALAGENCY(RENTALAGENCYID),
    CONSTRAINT CK_TRANSMISSIONTYPE CHECK (UPPER(TRANSMISSIONTYPE) IN ('MANUAL', 'AUTOMATIC', 'CONTINUOUSLY VARIABLE TRANSMISSION', 'SEMI-AUTOMATIC', 'DUAL-CLUTCH'))
);

CREATE TABLE CAR(
    VEHICLEID NUMBER(9) PRIMARY KEY,
    TRUNKCAPACITY NUMBER(4,2) NOT NULL,
    FOREIGN KEY (VEHICLEID) REFERENCES VEHICLE(VEHICLEID) 
);

CREATE TABLE MINIVAN(
    VEHICLEID NUMBER(9) PRIMARY KEY,
    HASDISABILLITYPACKAGE CHAR(1) NOT NULL,
    FOREIGN KEY (VEHICLEID) REFERENCES VEHICLE(VEHICLEID),
    CONSTRAINT ck_HASDISABILLITYPACKAGE CHECK (HASDISABILLITYPACKAGE IN ('0','1'))
);

CREATE TABLE SUV(
    VEHICLEID NUMBER(9) PRIMARY KEY,
    TOWINGCAPACITY NUMBER(6,2) NOT NULL,
    ISAWD CHAR(1) NOT NULL,
    CONSTRAINT ck_ISAWD CHECK (ISAWD IN ('0','1')),
    FOREIGN KEY (VEHICLEID) REFERENCES VEHICLE(VEHICLEID)
);

CREATE TABLE CARGOVAN(
    VEHICLEID NUMBER(9) PRIMARY KEY,
    CARGOCAPACITY NUMBER(3) NOT NULL,
    MAXIMUMPAYLOAD NUMBER(4) NOT NULL,
    FOREIGN KEY (VEHICLEID) REFERENCES VEHICLE(VEHICLEID)
);

CREATE TABLE USSTATE(
    STATEID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    STATECODE CHAR(2) UNIQUE NOT NULL,
    STATENAME VARCHAR2(40) NOT NULL
);

CREATE TABLE COUNTRY(
    COUNTRYID NUMBER(3) PRIMARY KEY,
    COUNTRYCODE2 CHAR(2) NOT NULL,
    COUNTRYCODE3 CHAR(3) NOT NULL,
    COUNTRYNAME VARCHAR2(75) NOT NULL
);


CREATE TABLE RENTALINSURANCEOPTION(
    INSURANCEOPTIONID NUMBER(1) PRIMARY KEY,
    INSURANCEOPTIONDESC VARCHAR2(200) NOT NULL,
    INSURANCEOPTIONADDITIONALCOST NUMBER(4,2) NOT NULL
);
CREATE TABLE FUELOPTION(
    FUELOPTIONID NUMBER(1) PRIMARY KEY,
    FUELOPTIONDESC VARCHAR2(100) NOT NULL
);

CREATE TABLE RENTALSTATUS(
    RENTALSTATUSID NUMBER(1) PRIMARY KEY,
    RENTALSTATUSDESC VARCHAR2(100) NOT NULL 
);

CREATE TABLE RESERVATIONSTATUS (
    RESERVATIONSTATUSID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    RESERVATIONSTATUSDESC VARCHAR2(100) NOT NULL
);

CREATE TABLE RESERVATION(
    RESERVATIONID NUMBER(9) PRIMARY KEY,
    CUSTOMERID NUMBER(9) NOT NULL,
    RENTALAGENCYID NUMBER(5) NOT NULL,
    VEHICLERENTALCATEGORYID NUMBER(2) NOT NULL,
    RESERVATIONDROPOFFAGENCYID NUMBER(5) NOT NULL,
    RESERVATIONPICKUPDATE DATE NOT NULL,
    RESERVATIONPICKUPTIME NUMBER(4) NOT NULL,
    RESERVATIONDROPOFFDATE DATE NOT NULL,
    RESERVATIONDROPOFFTIME NUMBER(4) NOT NULL,
    RESERVATIONSTATUSID NUMBER(1) NOT NULL,
    FOREIGN KEY (CUSTOMERID) REFERENCES CUSTOMER(CUSTOMERID),
    FOREIGN KEY (RENTALAGENCYID) REFERENCES RENTALAGENCY(RENTALAGENCYID),
    FOREIGN KEY (VEHICLERENTALCATEGORYID) REFERENCES VEHICLERENTALCATEGORY(VEHICLERENTALCATEGORYID),
    FOREIGN KEY (RESERVATIONDROPOFFAGENCYID) REFERENCES RENTALAGENCY(RENTALAGENCYID),
    FOREIGN KEY (RESERVATIONSTATUSID) REFERENCES RESERVATIONSTATUS(RESERVATIONSTATUSID)
);

CREATE TABLE RENTAL(
    RENTALAGREEMENTID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    CUSTOMERID NUMBER(9) NOT NULL,
    VEHICLEID NUMBER(9) NOT NULL,
    RENTALAGENCYID NUMBER(5) NOT NULL,
    RENTALDROPOFFAGENCYID NUMBER(5) NOT NULL,
    RESERVATIONID NUMBER(9) NULL,
    RENTALPICKUPDATE DATE NOT NULL,
    RENTALPICKUPTIME NUMBER(4) NOT NULL,
    RENTALDROPOFFDATE DATE NOT NULL,
    RENTALDROPOFFTIME NUMBER(4) NOT NULL,
    RENTALPICKUPODOMETERVALUE NUMBER(6) NOT NULL,
    RENTALDROPOFFODOMETERVALUE NUMBER(6) NOT NULL,
    RENTALFUELOPTIONID NUMBER(1) NOT NULL,
    INSURANCEOPTIONID NUMBER(1) NOT NULL,
    RENTALSTATUSID NUMBER(1) NOT NULL,
    RENTALDEPOSIT NUMBER(8,2) NOT NULL,
    FOREIGN KEY (CUSTOMERID) REFERENCES CUSTOMER(CUSTOMERID),
    FOREIGN KEY (VEHICLEID) REFERENCES VEHICLE(VEHICLEID),
    FOREIGN KEY (RENTALAGENCYID) REFERENCES RENTALAGENCY(RENTALAGENCYID),
    FOREIGN KEY (RENTALDROPOFFAGENCYID) REFERENCES RENTALAGENCY(RENTALAGENCYID),
    FOREIGN KEY (RESERVATIONID) REFERENCES  RESERVATION(RESERVATIONID),
    FOREIGN KEY (RENTALFUELOPTIONID) REFERENCES FUELOPTION(FUELOPTIONID),
    FOREIGN KEY (INSURANCEOPTIONID) REFERENCES RENTALINSURANCEOPTION(INSURANCEOPTIONID),
    FOREIGN KEY (RENTALSTATUSID) REFERENCES RENTALSTATUS(RENTALSTATUSID)
); 

CREATE TABLE EMPLOYEEUSERACCOUNT(
    USERACCOUNTID RAW(16) DEFAULT SYS_GUID() PRIMARY KEY,
    USERNAME VARCHAR2(50) NOT NULL,
    PASSWORD VARCHAR2(20) NOT NULL,
    EMAIL VARCHAR2(75) NOT NULL UNIQUE
);

CREATE TABLE EMPLOYEE(
    EMPLOYEEID NUMBER PRIMARY KEY,
    FIRSTNAME VARCHAR2(20) NOT NULL,
    LASTNAME VARCHAR2(20) NOT NULL,
    SSNUMBER CHAR(9) NOT NULL UNIQUE,
    BIRTHDATE DATE NOT NULL,
    ADDRESSLINE1 VARCHAR2(75) NOT NULL,
    ADDRESSLINE2 VARCHAR2(75) NULL,
    CITY VARCHAR2(50) NOT NULL,
    STATECODE CHAR(2) NOT NULL,
    ZIPCODE VARCHAR2(10) NOT NULL,
    COUNTRY VARCHAR2(75) NOT NULL,
    EMPLOYEEPHONE VARCHAR2(20) NOT NULL,
    EMPLOYEEJOBTITLE VARCHAR2(30) NOT NULL,
    EMPLOYEEEMAIL VARCHAR2(75) NOT NULL UNIQUE,
    EMPLOYEEUSERACCOUNTID RAW(16) NOT NULL,
    FOREIGN KEY (EMPLOYEEUSERACCOUNTID) REFERENCES EMPLOYEEUSERACCOUNT(USERACCOUNTID)
);

CREATE TABLE TRANSPORTSTATUS(
    TRANSPORTSTATUSID NUMBER(1) PRIMARY KEY,
    TRANSPORTSTATUSDESC VARCHAR2(50) NOT NULL
);

CREATE TABLE TRANSPORTREASON(
    TRANSPORTREASONID NUMBER(1) PRIMARY KEY,
    TRANSPORTREASONDESC VARCHAR2(100) NOT NULL
);
CREATE TABLE TRANSPORT(
    EMPLOYEEID NUMBER(9) NOT NULL,
    VEHICLEID NUMBER(9) NOT NULL,
    PICKUPRENTALAGENCYID NUMBER(5) NOT NULL,
    DROPOFFRENTALAGENCYID NUMBER(5) NOT NULL,
    DRIVERDEPARTUREDATE DATE NOT NULL,
    DRIVERDEPARTURETIME NUMBER(4) NOT NULL,
    VEHICLEPICKUPDATE DATE NOT NULL,
    VEHICLEPICKUPTIME NUMBER(4) NOT NULL,
    VEHICLEDROPOFFDATE DATE NOT NULL,
    VEHICLEDROPOFFTIME NUMBER(4) NOT NULL,
    TRANSPORTSTATUSID NUMBER(1) NOT NULL,
    TRANSPORTREASONID NUMBER(1) NOT NULL,
    FOREIGN KEY (EMPLOYEEID) REFERENCES EMPLOYEE(EMPLOYEEID),
    FOREIGN KEY (VEHICLEID) REFERENCES VEHICLE(VEHICLEID),
    FOREIGN KEY (PICKUPRENTALAGENCYID) REFERENCES RENTALAGENCY(RENTALAGENCYID),
    FOREIGN KEY (DROPOFFRENTALAGENCYID) REFERENCES RENTALAGENCY(RENTALAGENCYID),
    FOREIGN KEY (TRANSPORTSTATUSID) REFERENCES TRANSPORTSTATUS(TRANSPORTSTATUSID),
    FOREIGN KEY (TRANSPORTREASONID) REFERENCES TRANSPORTREASON(TRANSPORTREASONID)
);
ALTER TABLE TRANSPORT ADD CONSTRAINT PK_TRANSPORT PRIMARY KEY(EMPLOYEEID, VEHICLEID, PICKUPRENTALAGENCYID); 

